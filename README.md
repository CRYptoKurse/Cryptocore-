–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
CryptoCore - —ç—Ç–æ —É—Ç–∏–ª–∏—Ç–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ø–æ—ç—Ç–∞–ø–Ω–æ –≤ 5 —Å–ø—Ä–∏–Ω—Ç–∞—Ö. –ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫—É —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö.


üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
1. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
bash
# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
cryptocore encrypt --algorithm aes --mode cbc --key 00112233445566778899aabbccddeeff --input file.txt --output file.enc

# –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
cryptocore encrypt --decrypt --algorithm aes --mode cbc --key 00112233445566778899aabbccddeeff --input file.enc --output file.dec

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∫–ª—é—á–∞ –ø—Ä–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–∏
cryptocore encrypt --algorithm aes --mode cbc --input file.txt --output file.enc
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

--algorithm: –∞–ª–≥–æ—Ä–∏—Ç–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (—Ç–æ–ª—å–∫–æ aes)

--mode: —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã (ecb, cbc, cfb, ofb, ctr)

--key: –∫–ª—é—á –≤ hex (16 –±–∞–π—Ç –¥–ª—è AES-128, –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –ø—Ä–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–∏)

--input: –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª

--output: –≤—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

--decrypt: —Ñ–ª–∞–≥ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

--iv: –≤–µ–∫—Ç–æ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ hex (—Ç–æ–ª—å–∫–æ –¥–ª—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è)

-v: –ø–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥

2. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ö–µ—à-—Å—É–º–º –∏ HMAC
bash
# –û–±—ã—á–Ω–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
cryptocore dgst --algorithm sha256 --input file.txt
cryptocore dgst --algorithm sha3-256 --input file.txt --output hash.txt

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HMAC
cryptocore dgst --algorithm sha256 --hmac --key 00112233445566778899aabbccddeeff --input file.txt

# –ü—Ä–æ–≤–µ—Ä–∫–∞ HMAC
cryptocore dgst --algorithm sha256 --hmac --key 00112233445566778899aabbccddeeff --input file.txt --verify hmac.txt
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

--algorithm: –∞–ª–≥–æ—Ä–∏—Ç–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è (sha256, sha3-256)

--input: –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª

--output: –≤—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

--hmac: –≤–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º HMAC

--key: –∫–ª—é—á –¥–ª—è HMAC –≤ hex (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ --hmac)

--verify: —Ñ–∞–π–ª —Å –æ–∂–∏–¥–∞–µ–º—ã–º HMAC –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

-v: –ø–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥

üîß –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ä–µ–∂–∏–º—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ "—Å –Ω—É–ª—è":
ECB (Electronic Codebook) - –∫–∞–∂–¥—ã–π –±–ª–æ–∫ —à–∏—Ñ—Ä—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ

CBC (Cipher Block Chaining) - –∫–∞–∂–¥—ã–π –±–ª–æ–∫ XOR-–∏—Ç—Å—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º —à–∏—Ñ—Ä—Ç–µ–∫—Å—Ç–æ–º

CFB (Cipher Feedback) - –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –±–ª–æ—á–Ω—ã–π —à–∏—Ñ—Ä –≤ —Å–∞–º–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—â–∏–π—Å—è –ø–æ—Ç–æ–∫–æ–≤—ã–π

OFB (Output Feedback) - —Å–æ–∑–¥–∞–µ—Ç –ø–æ—Ç–æ–∫–æ–≤—ã–π —à–∏—Ñ—Ä –∏–∑ –±–ª–æ—á–Ω–æ–≥–æ

CTR (Counter) - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—á–µ—Ç—á–∏–∫ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—é—á–µ–≤–æ–≥–æ –ø–æ—Ç–æ–∫–∞

üìä –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ —Å–ø—Ä–∏–Ω—Ç–∞–º
–°–ø—Ä–∏–Ω—Ç 1: –ë–∞–∑–æ–≤—ã–π CLI –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
‚úÖ –ü–∞—Ä—Å–µ—Ä –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ —Å –ø–æ–¥–∫–æ–º–∞–Ω–¥–æ–π encrypt

‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ AES –≤ —Ä–µ–∂–∏–º–∞—Ö ECB –∏ CBC

‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –∫–ª—é—á–µ–π –∏ IV

‚úÖ –ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫

–°–ø—Ä–∏–Ω—Ç 2: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∂–∏–º–æ–≤ —Å –Ω—É–ª—è
‚úÖ –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è ECB, CBC, CFB, OFB, CTR

‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è PKCS#7

‚úÖ –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–°–ø—Ä–∏–Ω—Ç 3: –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ os.urandom() –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö –±–∞–π—Ç–æ–≤

‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π –∏ IV –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è

–°–ø—Ä–∏–Ω—Ç 4: –•–µ—à-—Ñ—É–Ω–∫—Ü–∏–∏
‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è SHA-256 —Å –Ω—É–ª—è

‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ SHA3-256 —á–µ—Ä–µ–∑ hashlib

‚úÖ –ü–æ—Ç–æ–∫–æ–≤–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤

‚úÖ –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞: –•–ï–®_–ó–ù–ê–ß–ï–ù–ò–ï –ü–£–¢–¨_–ö_–í–•–û–î–ù–û–ú–£_–§–ê–ô–õ–£

–°–ø—Ä–∏–Ω—Ç 5: HMAC (Hash-based Message Authentication Code)
‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è HMAC —Å –Ω—É–ª—è —Å–æ–≥–ª–∞—Å–Ω–æ RFC 2104

‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ SHA-256

‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–ª—é—á–µ–π –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã

‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ HMAC —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥ --verify

‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –≤–µ–∫—Ç–æ—Ä—ã RFC 4231 (—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∏–∑–≤–µ—Å—Ç–Ω–æ–π –æ—à–∏–±–∫–∏ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–ª—É—á–∞–µ 2)

üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ HMAC:
bash
python test_hmac.py
–¢–µ—Å—Ç—ã –≤–∫–ª—é—á–∞—é—Ç:
–¢–µ—Å—Ç–æ–≤—ã–µ –≤–µ–∫—Ç–æ—Ä—ã RFC 4231

–†–∞–∑–ª–∏—á–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∫–ª—é—á–µ–π

–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏—Å–∫–∞–∂–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤

–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–µ–≤–µ—Ä–Ω—ã—Ö –∫–ª—é—á–µ–π

–ü—Ä–æ–≤–µ—Ä–∫—É –ø—É—Å—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤

‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
–û—à–∏–±–∫–∞ –≤ RFC 4231:
–í —Ç–µ—Å—Ç–æ–≤–æ–º —Å–ª—É—á–∞–µ 2 RFC 4231 –µ—Å—Ç—å –æ–ø–µ—á–∞—Ç–∫–∞. –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ HMAC (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–æ–µ Python –∏ OpenSSL):

–ü–æ RFC: 5bdcc146bf68754e6a042426889575c75a003f089d2739839dec58b964ec3843

–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ: 5bdcc146bf60754e6a042426089575c75a003f089d2739839dec58b964ec3843

–ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —Å–æ–≤–ø–∞–¥–∞—é—â–µ–µ —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏.

–§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö:
–ö–ª—é—á–∏: —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ (hex)

IV: —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏, 16 –±–∞–π—Ç

–í—ã–≤–æ–¥ HMAC: HMAC_VALUE INPUT_FILE_PATH

–í—ã–≤–æ–¥ —Ö–µ—à–∞: HASH_VALUE INPUT_FILE_PATH

üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã:
–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π CSPRNG —á–µ—Ä–µ–∑ os.urandom()

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ HMAC

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ HMAC —Å –∫–ª—é—á–æ–º

–ó–∞—â–∏—Ç–∞ –æ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ - –ª—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –∫–ª—é—á–∞ –º–µ–Ω—è–µ—Ç HMAC

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
–î–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∂–∏–º—ã CBC, CFB, OFB –∏–ª–∏ CTR

–ò–∑–±–µ–≥–∞–π—Ç–µ —Ä–µ–∂–∏–º–∞ ECB –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ HMAC –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –Ω–µ–Ω–∞–¥–µ–∂–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

–•—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ

üìà –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
1. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
bash
# –®–∏—Ñ—Ä—É–µ–º —Ñ–∞–π–ª
cryptocore encrypt --algorithm aes --mode cbc --input secret.txt --output secret.enc

# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º HMAC –¥–ª—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
cryptocore dgst --algorithm sha256 --hmac --key $KEY --input secret.enc --output secret.hmac

# –ü—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º HMAC
cryptocore dgst --algorithm sha256 --hmac --key $KEY --input received.enc --verify secret.hmac
2. –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
bash
# –•–µ—à–∏—Ä—É–µ–º –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
for file in *.txt; do
    cryptocore dgst --algorithm sha256 --input "$file" >> hashes.txt
done
üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
–ü—Ä–æ–µ–∫—Ç CryptoCore —É—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç:

5 —Ä–µ–∂–∏–º–æ–≤ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è AES —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π

2 –∞–ª–≥–æ—Ä–∏—Ç–º–∞ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è (SHA-256 –∏ SHA3-256)

HMAC –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏

–ü–æ—Ç–æ–∫–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤

–ü–æ–ª–Ω—É—é CLI —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
